#Region System
FEEDSTRINGS;
SKIPCHECK;
UNDEFVALS;
#EndRegion

#Region N-Calculation rules: Dimension:Metric Indicators
#Autogenerated CALC NUMERIC 4D657472696320496E64696361746F7273
   #Region Dimension:Metric Indicators, Member:Status
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5374617475735D
   #@AutoGenerated
   ['Metric Indicators':{'Status'}]=N:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(['Metric Indicators':'Score']>=0, 
   1, 
   IF(['Metric Indicators':'Score']>=0-1, 
   0, 
   -1)));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Trend
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5472656E645D
   #@AutoGenerated
   ['Metric Indicators':{'Trend'}]=N:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score'])=1%ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score')))=1, 
   UNDEFINEDCELLVALUE, 
   IF(ABS(['Metric Indicators':'Score']-IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score')))>1*0.05, 
   SIGN(['Metric Indicators':'Score']-IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'))), 
   0));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Variance
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B56617269616E63655D
   #@AutoGenerated
   ['Metric Indicators':{'Variance'}]=N:['Metric Indicators':'Actual']-['Metric Indicators':'Target'];
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Variance Percent
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B56617269616E63652050657263656E745D
   #@AutoGenerated
   ['Metric Indicators':{'Variance Percent'}]=N:(['Metric Indicators':'Actual']-['Metric Indicators':'Target'])\['Metric Indicators':'Target'];
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Score
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B53636F72655D
   #@AutoGenerated
   ['Metric Indicators':{'Score'}]=N:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Target'])=1%ISUNDEFINEDCELLVALUE(['Metric Indicators':'Actual'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(IF(ATTRN('Metric-Financial', !Metric-Financial, 'tolerancetype')=1, 
   ['Metric Indicators':'Tolerance'], 
   ['Metric Indicators':'Tolerance']*['Metric Indicators':'Target'])<>0, 
   MAX(MIN(ROUNDP(0+IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1, 
   ABS(['Metric Indicators':'Actual']-['Metric Indicators':'Target']), 
   ['Metric Indicators':'Actual']-['Metric Indicators':'Target'])\ABS(IF(ATTRN('Metric-Financial', !Metric-Financial, 'tolerancetype')=1, 
   ['Metric Indicators':'Tolerance'], 
   ['Metric Indicators':'Tolerance']*['Metric Indicators':'Target']))*1*IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=0, 
   1, 
   -1)+IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1, 
   0.5*1, 
   0),5), 10), -10), 
   IF(['Metric Indicators':'Actual']=['Metric Indicators':'Target'], 
   0, 
   IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1  % SIGN(['Metric Indicators':'Actual']-['Metric Indicators':'Target']) * IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=0, 
   1, 
   -1) <0, 
   -10, 
   10))));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Score Change
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B53636F7265204368616E67655D
   #@AutoGenerated
   ['Metric Indicators':{'Score Change'}]=N:IF(((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   ['Metric Indicators':'Trend'], 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'))))=1),UNDEFINEDCELLVALUE,IF((ATTRS('Time', !Time, 'previousperiod')@<>''), 
   DB('Metrics cube-Financial', !country, !Time, !Metric-Financial, 'Score')-DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'), 
   CONTINUE));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Actual Change Percent
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B41637475616C204368616E67652050657263656E745D
   #@AutoGenerated
   ['Metric Indicators':{'Actual Change Percent'}]=N:IF(((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Actual']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   ['Metric Indicators':'Trend'], 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))))=1),UNDEFINEDCELLVALUE,(((DB('Metrics cube-Financial', !country, !Time, !Metric-Financial, 'Actual')-DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))\DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))*100)\100);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_1_Count
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5374617475735F315F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_1_Count'}]=N:IF(['Metric Indicators':'Status']=1,1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_0_Count
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5374617475735F305F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_0_Count'}]=N:IF((['Metric Indicators':'Status']=0)&((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Status']))=0),1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_-1_Count
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5374617475735F2D315F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_-1_Count'}]=N:IF(['Metric Indicators':'Status']=(-1),1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_Incomplete_Count
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B5374617475735F496E636F6D706C6574655F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_Incomplete_Count'}]=N:IF((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Status']))=1,1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Tolerance
   #Autogenerated MEMBERCALC NUMERIC 5B4D657472696320496E64696361746F72735D2E5B546F6C6572616E63655D
   #@AutoGenerated
   ['Metric Indicators':{'Tolerance'}]=N:STET;
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:Metric Indicators
#Autogenerated CALC CONSOLIDATED 4D657472696320496E64696361746F7273
   #Region Dimension:Metric Indicators, Member:Status
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5374617475735D
   #@AutoGenerated
   ['Metric Indicators':{'Status'}]=C:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(['Metric Indicators':'Score']>=0, 
   1, 
   IF(['Metric Indicators':'Score']>=0-1, 
   0, 
   -1)));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Trend
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5472656E645D
   #@AutoGenerated
   ['Metric Indicators':{'Trend'}]=C:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score'])=1%ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score')))=1, 
   UNDEFINEDCELLVALUE, 
   IF(ABS(['Metric Indicators':'Score']-IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score')))>1*0.05, 
   SIGN(['Metric Indicators':'Score']-IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'))), 
   0));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Tolerance
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B546F6C6572616E63655D
   #@AutoGenerated
   ['Metric Indicators':{'Tolerance'}]=C:ConsolidatedAvg(3, '', !country, !Time, !Metric-Financial, !Metric Indicators);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Variance
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B56617269616E63655D
   #@AutoGenerated
   ['Metric Indicators':{'Variance'}]=C:['Metric Indicators':'Actual']-['Metric Indicators':'Target'];
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Variance Percent
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B56617269616E63652050657263656E745D
   #@AutoGenerated
   ['Metric Indicators':{'Variance Percent'}]=C:(['Metric Indicators':'Actual']-['Metric Indicators':'Target'])\['Metric Indicators':'Target'];
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Score
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B53636F72655D
   #@AutoGenerated
   ['Metric Indicators':{'Score'}]=C:IF(ISUNDEFINEDCELLVALUE(['Metric Indicators':'Target'])=1%ISUNDEFINEDCELLVALUE(['Metric Indicators':'Actual'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(IF(ATTRN('Metric-Financial', !Metric-Financial, 'tolerancetype')=1, 
   ['Metric Indicators':'Tolerance'], 
   ['Metric Indicators':'Tolerance']*['Metric Indicators':'Target'])<>0, 
   MAX(MIN(ROUNDP(0+IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1, 
   ABS(['Metric Indicators':'Actual']-['Metric Indicators':'Target']), 
   ['Metric Indicators':'Actual']-['Metric Indicators':'Target'])\ABS(IF(ATTRN('Metric-Financial', !Metric-Financial, 'tolerancetype')=1, 
   ['Metric Indicators':'Tolerance'], 
   ['Metric Indicators':'Tolerance']*['Metric Indicators':'Target']))*1*IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=0, 
   1, 
   -1)+IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1, 
   0.5*1, 
   0),5), 10), -10), 
   IF(['Metric Indicators':'Actual']=['Metric Indicators':'Target'], 
   0, 
   IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=1  % SIGN(['Metric Indicators':'Actual']-['Metric Indicators':'Target']) * IF(ATTRN('Metric-Financial', !Metric-Financial, 'performancepattern')=0, 
   1, 
   -1) <0, 
   -10, 
   10))));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Score Change
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B53636F7265204368616E67655D
   #@AutoGenerated
   ['Metric Indicators':{'Score Change'}]=C:IF(((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Score']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   ['Metric Indicators':'Trend'], 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'))))=1),UNDEFINEDCELLVALUE,IF((ATTRS('Time', !Time, 'previousperiod')@<>''), 
   DB('Metrics cube-Financial', !country, !Time, !Metric-Financial, 'Score')-DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Score'), 
   CONTINUE));
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Actual Change Percent
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B41637475616C204368616E67652050657263656E745D
   #@AutoGenerated
   ['Metric Indicators':{'Actual Change Percent'}]=C:IF(((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Actual']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('Time', !Time, 'previousperiod')@='', 
   ['Metric Indicators':'Trend'], 
   DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))))=1),UNDEFINEDCELLVALUE,(((DB('Metrics cube-Financial', !country, !Time, !Metric-Financial, 'Actual')-DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))\DB('Metrics cube-Financial', !country, ATTRS('Time', !Time, 'previousperiod'), !Metric-Financial, 'Actual'))*100)\100);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_1_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5374617475735F315F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_1_Count'}]=C:IF(['Metric Indicators':'Status']=1,1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_0_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5374617475735F305F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_0_Count'}]=C:IF((['Metric Indicators':'Status']=0)&((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Status']))=0),1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_-1_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5374617475735F2D315F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_-1_Count'}]=C:IF(['Metric Indicators':'Status']=(-1),1,0);
   #EndRegion
   #Region Dimension:Metric Indicators, Member:Status_Incomplete_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D657472696320496E64696361746F72735D2E5B5374617475735F496E636F6D706C6574655F436F756E745D
   #@AutoGenerated
   ['Metric Indicators':{'Status_Incomplete_Count'}]=C:IF((ISUNDEFINEDCELLVALUE(['Metric Indicators':'Status']))=1,1,0);
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:Metric-Financial
#Autogenerated CALC CONSOLIDATED 4D65747269632D46696E616E6369616C
   #Region Dimension:Metric-Financial, Member:Gross margin
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D65747269632D46696E616E6369616C5D2E5B47726F7373206D617267696E5D
   #@AutoGenerated
   ['Metric-Financial':{'Gross margin'}]=C:ConsolidatedAvg(3, '', !country, !Time, !Metric-Financial, !Metric Indicators);
   #EndRegion
   #Region Dimension:Metric-Financial, Member:Bonus
   #Autogenerated MEMBERCALC CONSOLIDATED 5B4D65747269632D46696E616E6369616C5D2E5B426F6E75735D
   #@AutoGenerated
   ['Metric-Financial':{'Bonus'}]=C:ConsolidatedAvg(3, '', !country, !Time, !Metric-Financial, !Metric Indicators);
   #EndRegion
#EndRegion

#Region N-Calculation rules: Dimension:Metric-Financial
#Autogenerated CALC NUMERIC 4D65747269632D46696E616E6369616C
   #Region Dimension:Metric-Financial, Member:Gross margin
   #Autogenerated MEMBERCALC NUMERIC 5B4D65747269632D46696E616E6369616C5D2E5B47726F7373206D617267696E5D
   #@AutoGenerated
   ['Metric-Financial':{'Gross margin'}]=N:['Metric-Financial':'Gross profit']\['Metric-Financial':'Revenue'];
   #EndRegion
   #Region Dimension:Metric-Financial, Member:Gross profit
   #Autogenerated MEMBERCALC NUMERIC 5B4D65747269632D46696E616E6369616C5D2E5B47726F73732070726F6669745D
   #@AutoGenerated
   ['Metric-Financial':{'Gross profit'}]=N:['Metric-Financial':'Revenue']-['Metric-Financial':'Product cost']-['Metric-Financial':'Salary']-['Metric-Financial':'Employee expense']-['Metric-Financial':'Training cost']-['Metric-Financial':'Calculated Bonus'];
   #EndRegion
   #Region Dimension:Metric-Financial, Member:Calculated Bonus
   #Autogenerated MEMBERCALC NUMERIC 5B4D65747269632D46696E616E6369616C5D2E5B43616C63756C6174656420426F6E75735D
   #@AutoGenerated
   ['Metric-Financial':{'Calculated Bonus'}]=N:['Metric-Financial':'Salary']*['Metric-Financial':'Bonus'];
   #EndRegion
#EndRegion

#Region Link rule: Revenue - Numeric
#Source cube: Metrics cube-Sales
#Target cube: Metrics cube-Financial
#Autogenerated LINK NUMERIC 7D4C696E6B5F526576656E7565
#@AutoGenerated
['Metric-Financial':'Revenue'] = N:DB('Metrics cube-Sales', !country, 
    'Total of Product', 'Total of Retailer', !Time, 'Sales revenue', 
    !Metric Indicators);
#EndRegion

#Region Link rule: Revenue - String
#Source cube: Metrics cube-Sales
#Target cube: Metrics cube-Financial
#Autogenerated LINK STRING 7D4C696E6B5F526576656E7565
#@AutoGenerated
['Metric-Financial':'Revenue'] = S:DB('Metrics cube-Sales', !country, 
    'Total of Product', 'Total of Retailer', !Time, 'Sales revenue', 
    !Metric Indicators);
#EndRegion

FEEDERS;
#Region Automatically generated feeders
#Autogenerated AUTOFEEDERS
['Metric Indicators':'Score'] => ['Metric Indicators':'Score Change'];
['Metric Indicators':'Status'] => ['Metric Indicators':'Status_1_Count'];
['Metric Indicators':{'Target', 'Actual'}] => ['Metric Indicators':'Variance'];
['Metric Indicators':'Actual'] => ['Metric Indicators':'Actual Change Percent'];
['Metric Indicators':'Status'] => ['Metric Indicators':'Status_0_Count'];
['Metric Indicators':'Actual'] => ['Metric Indicators':'Score'];
['Metric-Financial':'Bonus', 'Metric Indicators':{'Target', 'Actual', 'Score Change'}] => ['Metric-Financial':'Calculated Bonus'];
['Metric-Financial':{'Calculated Bonus', 'Training cost', 'Product cost', 'Revenue', 'Salary', 'Employee expense'}, 'Metric Indicators':{'Target', 'Actual', 'Score Change'}] => ['Metric-Financial':'Gross profit'];
['Metric Indicators':'Target'] => ['Metric Indicators':'Variance Percent'];
['Metric Indicators':'Status'] => ['Metric Indicators':'Status_-1_Count'];
['Metric Indicators':'Score'] => ['Metric Indicators':'Trend'];
['Metric Indicators':'Score'] => ['Metric Indicators':'Status'];
['Metric-Financial':'Gross profit', 'Metric Indicators':{'Target', 'Actual', 'Score Change'}] => ['Metric-Financial':'Gross margin'];
[] => DB('GO_Scorecards', !country, !Time, !Metric-Financial, !Metric Indicators);
#EndRegion